{% extends 'layout.html' %}
{% from 'aux_macros.html' import result_item, category_head %}

{% block app_content %}

    {% if 'get'==method %}
        {% include 'bar_search.html' %}
        <div class="s01 padding-5">
            <p>Search results are sorted by validity into three categories:<br>
                <strong>highly validated</strong> results,
                where the reference is tagged with the subject in more than one book; <br>
                <strong>validated</strong> results,
                where the reference is tagged with the subject only in one book, but more than once; <br>
                and <strong>non-validated</strong> results,
                where the reference is tagged with the subject only once, in one book.
            </p>
        </div>
    {% else %}
        <div class="container-fluid padding-bot-2">
            <div class="row">
                <!-- Title & Results Info -->
                <div class="col-lg-4 text-center ">
                    <h1 class="display-4 head-title padding-bot-2">
                        There are {{ results_num }} results for: <em>{{ search_word }}</em>
                    </h1>
                    {% for id, category in categories.items() %}
                        <h6>{{ category['results']|length }}
                            <a class="popover_ctgry" href='#{{ id }}'>{{ category['name'] }} </a> results.
                        </h6>
                    {% endfor %}
                </div>
                <!-- Search & Filter Forms -->
                <div class="col-lg-8">
                    <p class='padding-1 color-accent text-center small'>Query time: {{ query_time|round(3) }} s.</p>
                    {% include 'bar_search.html' %}
                </div>
            </div>
            <hr>
        </div>
        <!-- Results Divided Validation Category Sections -->
        {% for id, category in categories.items() %}
            {{ category_head(category['name'], id) }}
            <div class="category-padding">
                {% if not category['results'] %}
                    <h3>No results in this category.</h3>
                    <h4>Try using a different filter or search word.</h4>
                {% endif %}
                {% set outer_loop = loop %}
                {% for res in category['results'] %}
                    <div class="padding-bot-2">
                        <!-- Results (Per Category) -->
                        {{ result_item(
                        index = loop.index,
                        author=res.author,
                        title=res.title,
                        books=res.books_dict,
                        refs=res.refs,
                        num=res.num) }}
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    {% endif %}

{% endblock %}

{#
                {% set elm_id=num %}
                {% set btn_id='btn'~num %}
                <button id='{{ btn_id }}' class="padding bgn-dark"
                        onclick="more_less_info('{{ btn_id }}','{{ elm_id }}')">
                    Show More
                </button>
                <br><br>
                <p class="display-none" id={{ elm_id }}>
                    preview of the text (???)
                </p>
#}
