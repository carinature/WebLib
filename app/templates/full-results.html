{% extends 'layout.html' %}

{% block app_content %}


    <div class="container-fluid padding">
        <div class="row welcome text-center">
            <div class="col-12">
                <h1 class="display-4 welcome text-center padding">There are {{ results|length|value_or_zero }} results.</h1>
                <h6>{{ y|value_or_zero }} are highly validates results.</h6>
                <h6>{{ z|value_or_zero }} are highly validates results.</h6>
                <h6>{{ w|value_or_zero }} are highly validates results.</h6>
            </div>
            <hr>
        </div>
    </div>


    {% for category in categories %}
        {{ category_head(category['name']) }}
        {% for res in category['results'] %}
            {{ result_item(loop.index, res['author'], res['title'], res['refs_num'], res['refs'], loop.index) }}
            {#            {{ temp_result_item(item_index=loop.index,#}
            {#            subject=res.subject,#}
            {#            csum=res.Csum,#}
            {#                clist=result_clists[loop.index0],#}
            {#            clist_full=res.C) }}<br> #}
        {% endfor %}
    {% endfor %}


    {% for num, res in results.items() %}
        {{ result_item(index = loop.index, author=res.author, title=res.title, books=res.books, refs=res.refs, num=num) }}
        <br>
    {% endfor %}


    <script src='../static/js/script.js'></script>

{% endblock %}


{% macro result_item(index = 0, author='', title='', books={}, refs=[], num='') -%}
    <div class="container-fluid">
        {#        <span style="display: inline">#}
        {#        <div class="col-12" style="background-color: var(--secondary-color-light)"> <!--todo move the style to css-->#}
        <h4 class="" style="display: inline; padding-bottom: 10px;">
            {{ index }}. {{ author }}, <em>{{ title }}</em></h4>
        <h6 style="display: inline">
            {% set length=books|length %}
            ( {{ length }} {% if 1==length -%} reference: {% else %} references: {%- endif %}
            {% for ref in refs -%}
                <em>{{ ref }}</em>
            {%- endfor %} ) </h6>
        {#        </span>#}
        <br>
        <div style="padding-left: 2em">
            {% for book in books %}
                {#                {{ book }}#}
                <br><em><b>{{ book.title_full }}</b></em>, pages:
                {% for page in book.pages -%}
                    <a href="{{ link }}">{{ page }}</a>{% if loop.index0!=(books|length) %}, {% endif %}
                {%- endfor %}
                <br>
            {% endfor %}<br>
                        {% set elm_id=num %}
                        {% set btn_id='btn'~num %}
                        <button id={{ btn_id }} class="" style="padding:.5em; background-color: var(--accent-color)"
                                onclick="more_less_info('{{ btn_id }}','{{ elm_id }}')">Show More
                        </button>
                        <br><br>
                        <p style="display: none" id={{ elm_id }}>
                            preview of the text (???)
                        </p>
            <br><br>
        </div>
    </div>
{%- endmacro %}

{% macro category_head(category='', res_num='', name='', value='') -%}
    <div class="container-fluid padding">
        <div class="col-12" style="background-color: var(--secondary-color-light)"> <!--todo move the style to css-->
            <h1 class="">{{ category }} {{ res_num }}</h1>
            {#            <h1 class="display-4 welcome text-center">Tiresias: The Ancient Mediterranean Religions Source Database</h1>#}
        </div>
    </div>
{%- endmacro %}

